## Теория

### server.js

[Файл server.js](./src/server.js) задает все настройки сервера

-   Какие плагины использовать
-   К какой Базе Данных (БД) и по какому адресу подключаться
-   Какие маршруты есть и какие методы контроллера вызывать для них. Например, если клиент вызвал **POST запрос** по адресу **"/shows"**, то роутер вызовет метод **ShowsController.create** и этот метод будет вызван

### Контроллеры

[Контроллеры](./src/controllers/) отвечают за взаимодействие клиента (фронта) с бэком:

-   в них определяется, какие данные поступают, что с ними делать и какие данные возвращаются + обработка возможных ошибок.
-   здесь происходит чтение/создание/обновление/удаление данных, работа с БД

### Модели (show, user)

-   [Модели](./src/models/) описывают каркас/схему сущности (спектакль/пользователь) в базе данных MongoDB.
-   В них задаются свойства/типы этих свойств

### Сервис

Также в приложении есть сервис для работы с файлами, который служит для сохранения приходящих с фронта изображений на сервере

### static

-   В папке [static](./src/static/) буду храниться изображения, которые приходят с клиента. В БД мы храним только названия изображений, т.к. так с текстом БД работает гораздо быстрее + проще настроить ее

## Установка зависимостей

```
npm install
```

## Запуск приложения

```bash
npm run start # обычный запуск
npm run dev # режим разработки (перезагрузка сервера при изменениях в коде)
```

## Запуск сервера локально

Для локального запуска на машине должны быть установлены

-   [Node.js](https://nodejs.org/en/)
-   MongoDB [MongoDB](https://www.mongodb.com/docs/manual/administration/install-community/)

### Установка MongoDB для Windows

-   сначала по этой инструкции скачать/установить (до раздела **"Install mongosh"**) https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-windows/#procedure

-   потом вот это (только раздел **"Install from MSI"**)
    https://www.mongodb.com/docs/mongodb-shell/install/#install-from-msi

### Установка MongoDB для MacOS (на февраль 2023):

```bash
xcode-select --install
brew tap mongodb/brew
brew install mongodb-community

sudo mkdir -p /System/Volumes/Data/data/db # mongodb data directory
sudo chown -R `id -un` /System/Volumes/Data/data/db
```

-   Также находясь в [директории сервера](./server/) необходимо установить все зависимости:

```bash
npm install # установка всех зависимостей
```

Непосредственно запуск состоит из следующих этапов:

1. Запуск сервера mongodb (НУЖНО ЗАПУСКАТЬ КАЖДЫЙ РАЗ ВМЕСТЕ С ПРИЛОЖЕНИЕМ!)

```bash
sudo mongod --dbpath /System/Volumes/Data/data/db # (ctrl+c для выхода/завершения)

# в другом окне терминала (при активном сервере можно запустить консоли управления mongodb)
mongosh # (написать 'quit' для выхода)
```

2. Запуск приложения (находясь в [директории сервера](./server/)):

```bash
npm start
# или
node server.js
```

Оба пункта (запуск сервера mongodb и приложения) необхоимо выполнять каждый раз
